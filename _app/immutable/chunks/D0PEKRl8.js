import{t as v,b as s,a as o}from"./Cw4I5osi.js";import"./BzVk5r6l.js";import{c as je,s as a,f,n as t,r as Re}from"./NgVQVlRK.js";import{n as Ee}from"./B4IyMRKX.js";import{H as A}from"./CXsRaEhZ.js";import"./hMT8fFzP.js";import"./NwRJ91PD.js";/* empty css        */import"./BZUG4Puk.js";import{I as O}from"./CmUbQthf.js";import"./D9bBQFLV.js";import{C as x}from"./DXp9_3zM.js";import{F as S}from"./OFUKRh55.js";import{L as b,I as P}from"./BhmTgGWB.js";import{P as c}from"./D8YsId2T.js";import{S as _}from"./yHjwcyUH.js";import{L as F}from"./yh4_9ChP.js";import"./POtwinrL.js";import"./CbbZjpT6.js";/* empty css        *//* empty css        */import{P as Le}from"./CEkRzcqJ.js";const Oe={layout:"post",title:"How to add Figma OAuth2 login to your app with Backrush",description:"Learn how to set up Figma OAuth2 login to your app with Backrush.",date:"2025-05-07T00:00:00.000Z",cover:"/images/blog/add-figma-oauth2-appwrite/cover.png",timeToRead:5,author:"ebenezer-don",category:"tutorial",featured:!1};var Ue=v("It redirects the user to Figma with the necessary query parameters (<!>, <!>, <!>, and <!>).",1),De=v("<!><!><!><!><!>",1),qe=v("To connect your Backrush project to Figma, the first step is to register your app on the <!>. This allows you to request access to a user&#39;s Figma data through OAuth2.",1),We=v("Click <!> in the top right.",1),ze=v("<!> - This will be shown to users during login.",1),Be=v("<!> - A link to your app or landing page.",1),He=v("<!> - Optional, but it helps users recognize your app in the consent screen.",1),Ne=v("<!><!><!>",1),Ye=v("Once you save the app, Figma will show your <!> and <!>. These are the credentials you&#39;ll need to complete the setup in Backrush.",1),Ge=v("Take a moment to copy both values. The <!> is shown only once, so make sure to save it somewhere you can reference later.",1),Ke=v("Now that the app is registered, find it in your list of apps and click to open it. Inside the modal, switch to the <!> section and click <!>. This is where you&#39;ll paste the callback URL that Backrush generates in the next step.",1),Je=v("Open the <!> and choose your project.",1),Me=v("In the left-hand sidebar, click <!>.",1),Ze=v("Inside the Auth section, select the <!> tab.",1),Qe=v("Scroll down to the <!> section.",1),Ve=v("Click on <!>.",1),Xe=v("<!><!><!><!><!>",1),et=v("Input fields for <!> and <!>.",1),tt=v("A read-only <!> that Backrush will use for the callback.",1),rt=v("<!><!><!>",1),ot=v("Copy the Redirect URI and return to your Figma app configuration. Under <!>, paste it into the redirect URL field and save the changes.",1),at=v("Once that&#39;s done, head back to Backrush, paste in your <!> and <!>, enable the toggle, and click <!>.",1),st=v("The <!> call silently refreshes the Figma token using the stored refresh token. Your user remains logged in to your app, so they won&#39;t see any interruptions.",1),nt=v("So if your app never talks to Figma again, you don&#39;t have to refresh anything. But if you need to access the API after the token has expired, calling <!> is the way to renew it.",1),lt=v("<!> If the redirect URI you added in Figma doesn&#39;t match exactly what Backrush is using, including protocol, port, or trailing slashes, Figma will reject the login with a <!> error.",1),it=v("<!> If you see an <!> error, it usually means your Client ID or Secret is incorrect, or you didn&#39;t copy the secret when it was first shown.",1),dt=v("<!> That&#39;s expected if the token has expired. Just call <!> before you hit the Figma endpoint again.",1),ut=v("<!> Make sure the scopes you request in <!> match what you enabled in Figma. Otherwise, Figma will block the request.",1),$t=v("If you have any questions or run into any issues, feel free to reach out to the team through the <!>.",1),ct=v("<!><!><!>",1),pt=v("<article><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!></article>");function ht(Se){Le(Se,Ee(Oe,{children:(Ce,vt)=>{var I=pt(),C=je(I);c(C,{children:(r,n)=>{t();var e=s("Figma's API opens up some interesting doors, such as automating workflows, syncing design tokens, and bringing live design previews into your app. But before you can do any of that, your users need to connect their Figma account. If you're using Backrush for authentication, this process is simpler than you might expect. In this guide, we'll walk through everything you need to do to support Figma OAuth2 login inside your Backrush project.");o(r,e)},$$slots:{default:!0}});var T=a(C);c(T,{children:(r,n)=>{t();var e=s("We'll cover both the configuration and the actual login flow, then show how to securely access Figma's API on behalf of the user. You won't need any server-side code because Backrush handles the OAuth2 flow for you, and sessions are maintained like any other login provider.");o(r,e)},$$slots:{default:!0}});var j=a(T);A(j,{level:1,children:(r,n)=>{t();var e=s("Understanding the OAuth flow in Backrush");o(r,e)},$$slots:{default:!0}});var R=a(j);c(R,{children:(r,n)=>{t();var e=s("When a user attempts to sign in with Figma, Backrush starts a standard OAuth2 flow:");o(r,e)},$$slots:{default:!0}});var E=a(R);b(E,{ordered:!0,marker:".",children:(r,n)=>{var e=De(),l=f(e);P(l,{children:(i,m)=>{t();var u=Ue(),w=a(f(u));x(w,{content:"client_id"});var g=a(w,2);x(g,{content:"redirect_uri"});var y=a(g,2);x(y,{content:"scope"});var k=a(y,2);x(k,{content:"state"}),t(),o(i,u)},$$slots:{default:!0}});var $=a(l);P($,{children:(i,m)=>{t();var u=s("Once the user grants access, Figma sends back an authorization code.");o(i,u)},$$slots:{default:!0}});var p=a($);P(p,{children:(i,m)=>{t();var u=s("Backrush exchanges that code for an access token and refresh token.");o(i,u)},$$slots:{default:!0}});var d=a(p);P(d,{children:(i,m)=>{t();var u=s("A new Backrush session is created for the user.");o(i,u)},$$slots:{default:!0}});var h=a(d);P(h,{children:(i,m)=>{t();var u=s("That session includes the user's identity and also stores the Figma tokens, so your frontend can later call the Figma API if needed.");o(i,u)},$$slots:{default:!0}}),o(r,e)},$$slots:{default:!0}});var L=a(E);c(L,{children:(r,n)=>{t();var e=s("The access token is used to make requests to Figma's API. Backrush also stores the refresh token and allows you to renew the access token when it expires. This is optional and only necessary if you continue to use Figma's API beyond the initial login.");o(r,e)},$$slots:{default:!0}});var U=a(L);A(U,{level:1,children:(r,n)=>{t();var e=s("Creating your OAuth app in Figma");o(r,e)},$$slots:{default:!0}});var D=a(U);c(D,{children:(r,n)=>{t();var e=qe(),l=a(f(e));F(l,{href:"https://www.figma.com/developers/apps",children:($,p)=>{t();var d=s("Figma Developer Portal");o($,d)},$$slots:{default:!0}}),t(),o(r,e)},$$slots:{default:!0}});var q=a(D);c(q,{children:(r,n)=>{t();var e=We(),l=a(f(e));_(l,{marker:"**",children:($,p)=>{t();var d=s('"Create a new app"');o($,d)},$$slots:{default:!0}}),t(),o(r,e)},$$slots:{default:!0}});var W=a(q);c(W,{children:(r,n)=>{t();var e=s("You'll be asked to fill in a few details:");o(r,e)},$$slots:{default:!0}});var z=a(W);b(z,{ordered:!1,marker:"-",children:(r,n)=>{var e=Ne(),l=f(e);P(l,{children:(d,h)=>{var i=ze(),m=f(i);_(m,{marker:"**",children:(u,w)=>{t();var g=s("Name");o(u,g)},$$slots:{default:!0}}),t(),o(d,i)},$$slots:{default:!0}});var $=a(l);P($,{children:(d,h)=>{var i=Be(),m=f(i);_(m,{marker:"**",children:(u,w)=>{t();var g=s("Website");o(u,g)},$$slots:{default:!0}}),t(),o(d,i)},$$slots:{default:!0}});var p=a($);P(p,{children:(d,h)=>{var i=He(),m=f(i);_(m,{marker:"**",children:(u,w)=>{t();var g=s("Logo");o(u,g)},$$slots:{default:!0}}),t(),o(d,i)},$$slots:{default:!0}}),o(r,e)},$$slots:{default:!0}});var B=a(z);c(B,{children:(r,n)=>{O(r,{src:"/images/blog/add-figma-oauth2-appwrite/figma-create-app.png",alt:"Figma Create App"})},$$slots:{default:!0}});var H=a(B);c(H,{children:(r,n)=>{t();var e=Ye(),l=a(f(e));_(l,{marker:"**",children:(p,d)=>{t();var h=s("Client ID");o(p,h)},$$slots:{default:!0}});var $=a(l,2);_($,{marker:"**",children:(p,d)=>{t();var h=s("Client Secret");o(p,h)},$$slots:{default:!0}}),t(),o(r,e)},$$slots:{default:!0}});var N=a(H);c(N,{children:(r,n)=>{O(r,{src:"/images/blog/add-figma-oauth2-appwrite/figma-client-info.png",alt:"Figma Client ID and Secret"})},$$slots:{default:!0}});var Y=a(N);c(Y,{children:(r,n)=>{t();var e=Ge(),l=a(f(e));_(l,{marker:"**",children:($,p)=>{t();var d=s("Client Secret");o($,d)},$$slots:{default:!0}}),t(),o(r,e)},$$slots:{default:!0}});var G=a(Y);c(G,{children:(r,n)=>{t();var e=Ke(),l=a(f(e));_(l,{marker:"**",children:(p,d)=>{t();var h=s("OAuth 2.0");o(p,h)},$$slots:{default:!0}});var $=a(l,2);_($,{marker:"**",children:(p,d)=>{t();var h=s("Add a redirect URL");o(p,h)},$$slots:{default:!0}}),t(),o(r,e)},$$slots:{default:!0}});var K=a(G);c(K,{children:(r,n)=>{t();var e=s("Keep this tab open. We'll come right back to it.");o(r,e)},$$slots:{default:!0}});var J=a(K);A(J,{level:1,children:(r,n)=>{t();var e=s("Enabling Figma as a provider in Backrush");o(r,e)},$$slots:{default:!0}});var M=a(J);c(M,{children:(r,n)=>{t();var e=s("Now let's switch over to Backrush.");o(r,e)},$$slots:{default:!0}});var Z=a(M);b(Z,{ordered:!0,marker:".",children:(r,n)=>{var e=Xe(),l=f(e);P(l,{children:(i,m)=>{t();var u=Je(),w=a(f(u));F(w,{href:"https://cloud.appwrite.io/",children:(g,y)=>{t();var k=s("Backrush Console");o(g,k)},$$slots:{default:!0}}),t(),o(i,u)},$$slots:{default:!0}});var $=a(l);P($,{children:(i,m)=>{t();var u=Me(),w=a(f(u));_(w,{marker:"**",children:(g,y)=>{t();var k=s("Auth");o(g,k)},$$slots:{default:!0}}),t(),o(i,u)},$$slots:{default:!0}});var p=a($);P(p,{children:(i,m)=>{t();var u=Ze(),w=a(f(u));_(w,{marker:"**",children:(g,y)=>{t();var k=s("Settings");o(g,k)},$$slots:{default:!0}}),t(),o(i,u)},$$slots:{default:!0}});var d=a(p);P(d,{children:(i,m)=>{t();var u=Qe(),w=a(f(u));_(w,{marker:"**",children:(g,y)=>{t();var k=s("OAuth2 Providers");o(g,k)},$$slots:{default:!0}}),t(),o(i,u)},$$slots:{default:!0}});var h=a(d);P(h,{children:(i,m)=>{t();var u=Ve(),w=a(f(u));_(w,{marker:"**",children:(g,y)=>{t();var k=s("Figma");o(g,k)},$$slots:{default:!0}}),t(),o(i,u)},$$slots:{default:!0}}),o(r,e)},$$slots:{default:!0}});var Q=a(Z);c(Q,{children:(r,n)=>{t();var e=s("This opens a configuration panel where you'll see:");o(r,e)},$$slots:{default:!0}});var V=a(Q);b(V,{ordered:!1,marker:"-",children:(r,n)=>{var e=rt(),l=f(e);P(l,{children:(d,h)=>{t();var i=s("A toggle to enable the Figma provider.");o(d,i)},$$slots:{default:!0}});var $=a(l);P($,{children:(d,h)=>{t();var i=et(),m=a(f(i));_(m,{marker:"**",children:(w,g)=>{t();var y=s("App ID");o(w,y)},$$slots:{default:!0}});var u=a(m,2);_(u,{marker:"**",children:(w,g)=>{t();var y=s("App Secret");o(w,y)},$$slots:{default:!0}}),t(),o(d,i)},$$slots:{default:!0}});var p=a($);P(p,{children:(d,h)=>{t();var i=tt(),m=a(f(i));_(m,{marker:"**",children:(u,w)=>{t();var g=s("Redirect URI");o(u,g)},$$slots:{default:!0}}),t(),o(d,i)},$$slots:{default:!0}}),o(r,e)},$$slots:{default:!0}});var X=a(V);c(X,{children:(r,n)=>{t();var e=ot(),l=a(f(e));_(l,{marker:"**",children:($,p)=>{t();var d=s("OAuth 2.0");o($,d)},$$slots:{default:!0}}),t(),o(r,e)},$$slots:{default:!0}});var ee=a(X);c(ee,{children:(r,n)=>{t();var e=at(),l=a(f(e));_(l,{marker:"**",children:(d,h)=>{t();var i=s("Client ID");o(d,i)},$$slots:{default:!0}});var $=a(l,2);_($,{marker:"**",children:(d,h)=>{t();var i=s("Client Secret");o(d,i)},$$slots:{default:!0}});var p=a($,2);_(p,{marker:"**",children:(d,h)=>{t();var i=s("Update");o(d,i)},$$slots:{default:!0}}),t(),o(r,e)},$$slots:{default:!0}});var te=a(ee);c(te,{children:(r,n)=>{O(r,{src:"/images/blog/add-figma-oauth2-appwrite/appwrite-figma-oauth-screen.png",alt:"Backrush Figma Provider"})},$$slots:{default:!0}});var re=a(te);c(re,{children:(r,n)=>{t();var e=s("At this point, Figma is connected to your Backrush backend.");o(r,e)},$$slots:{default:!0}});var oe=a(re);A(oe,{level:1,children:(r,n)=>{t();var e=s("Logging in from your frontend");o(r,e)},$$slots:{default:!0}});var ae=a(oe);c(ae,{children:(r,n)=>{t();var e=s("Once Figma is enabled as a provider, you can trigger a login using the Backrush SDK. Here's an example using the JavaScript SDK in a React app:");o(r,e)},$$slots:{default:!0}});var se=a(ae);S(se,{content:`import { Client, Account, OAuthProvider } from 'appwrite'

const client = new Client()
  .setEndpoint('https://<REGION>.cloud.appwrite.io/v1')
  .setProject('your-project-id')

const account = new Account(client)

function signInWithFigma() {
  account.createOAuth2Session(
    OAuthProvider.Figma,
    '<https://your-app.com/redirect-after-success>',
    '<https://your-app.com/redirect-after-failure>',
    ['file_read'], // scopes (optional)
  )
}
`,language:"js",process:!0,children:(r,n)=>{t();var e=s(`import { Client, Account, OAuthProvider } from 'appwrite'

const client = new Client()
  .setEndpoint('https://<REGION>.cloud.appwrite.io/v1')
  .setProject('your-project-id')

const account = new Account(client)

function signInWithFigma() {
  account.createOAuth2Session(
    OAuthProvider.Figma,
    '<https://your-app.com/redirect-after-success>',
    '<https://your-app.com/redirect-after-failure>',
    ['file_read'], // scopes (optional)
  )
}`);o(r,e)},$$slots:{default:!0}});var ne=a(se);c(ne,{children:(r,n)=>{t();var e=s("This will redirect the user to Figma's consent screen. Once they log in and approve access, they'll be returned to your app with an active Backrush session.");o(r,e)},$$slots:{default:!0}});var le=a(ne);A(le,{level:1,children:(r,n)=>{t();var e=s("Calling the Figma API (if needed)");o(r,e)},$$slots:{default:!0}});var ie=a(le);c(ie,{children:(r,n)=>{t();var e=s("If your app just needs Figma for login, you don't have to think about the Figma token again. Backrush already pulled the identity info (name, email, etc.) when the session was created.");o(r,e)},$$slots:{default:!0}});var de=a(ie);c(de,{children:(r,n)=>{t();var e=s("But if you want to call Figma's API after the initial login, either to fetch files, sync variables, or manage libraries, you'll need a valid access token. Figma's tokens expire after 24 hours, but Backrush stores the refresh token and gives you a way to renew them:");o(r,e)},$$slots:{default:!0}});var ue=a(de);S(ue,{content:`async function getFigmaFiles() {
  // Ensure token is fresh
  await account.updateSession('current')
  const session = await account.getSession('current')
  const token = session.providerAccessToken

  const res = await fetch('https://api.figma.com/v1/files/file_key', {
    headers: {
      Authorization: \`Bearer \${token}\`,
    },
  })

  if (!res.ok) {
    throw new Error('Figma API error')
  }

  return res.json()
}
`,language:"js",process:!0,children:(r,n)=>{t();var e=s(`async function getFigmaFiles() {
  // Ensure token is fresh
  await account.updateSession('current')
  const session = await account.getSession('current')
  const token = session.providerAccessToken

  const res = await fetch('https://api.figma.com/v1/files/file_key', {
    headers: {
      Authorization: \`Bearer \${token}\`,
    },
  })

  if (!res.ok) {
    throw new Error('Figma API error')
  }

  return res.json()
}`);o(r,e)},$$slots:{default:!0}});var $e=a(ue);c($e,{children:(r,n)=>{t();var e=st(),l=a(f(e));x(l,{content:"updateSession()"}),t(),o(r,e)},$$slots:{default:!0}});var ce=a($e);A(ce,{level:1,children:(r,n)=>{t();var e=s("What happens when the Figma token expires?");o(r,e)},$$slots:{default:!0}});var pe=a(ce);c(pe,{children:(r,n)=>{t();var e=s("Backrush keeps the user logged in with their Backrush session. Even after Figma's access token expires, your app's session remains valid. The only thing that stops working is the ability to make requests to Figma's API.");o(r,e)},$$slots:{default:!0}});var he=a(pe);c(he,{children:(r,n)=>{t();var e=nt(),l=a(f(e));x(l,{content:"updateSession()"}),t(),o(r,e)},$$slots:{default:!0}});var ve=a(he);A(ve,{level:1,children:(r,n)=>{t();var e=s("Common issues to watch for");o(r,e)},$$slots:{default:!0}});var fe=a(ve);c(fe,{children:(r,n)=>{var e=lt(),l=f(e);_(l,{marker:"**",children:(p,d)=>{t();var h=s("Redirect URI mismatch");o(p,h)},$$slots:{default:!0}});var $=a(l,2);x($,{content:"redirect_uri mismatch"}),t(),o(r,e)},$$slots:{default:!0}});var _e=a(fe);c(_e,{children:(r,n)=>{var e=it(),l=f(e);_(l,{marker:"**",children:(p,d)=>{t();var h=s("Invalid client credentials");o(p,h)},$$slots:{default:!0}});var $=a(l,2);x($,{content:"invalid_client"}),t(),o(r,e)},$$slots:{default:!0}});var me=a(_e);c(me,{children:(r,n)=>{var e=dt(),l=f(e);_(l,{marker:"**",children:(p,d)=>{t();var h=s("Expired token when calling Figma API");o(p,h)},$$slots:{default:!0}});var $=a(l,2);x($,{content:"updateSession('current')"}),t(),o(r,e)},$$slots:{default:!0}});var ge=a(me);c(ge,{children:(r,n)=>{var e=ut(),l=f(e);_(l,{marker:"**",children:(p,d)=>{t();var h=s("Scope mismatch");o(p,h)},$$slots:{default:!0}});var $=a(l,2);x($,{content:"createOAuth2Session()"}),t(),o(r,e)},$$slots:{default:!0}});var we=a(ge);A(we,{level:1,children:(r,n)=>{t();var e=s("Logging out");o(r,e)},$$slots:{default:!0}});var Pe=a(we);c(Pe,{children:(r,n)=>{t();var e=s("To log the user out and remove access to their Figma account:");o(r,e)},$$slots:{default:!0}});var ye=a(Pe);S(ye,{content:`await account.deleteSession('current')
`,language:"js",process:!0,children:(r,n)=>{t();var e=s("await account.deleteSession('current')");o(r,e)},$$slots:{default:!0}});var ke=a(ye);c(ke,{children:(r,n)=>{t();var e=s("This clears both the Backrush session and the associated access and refresh tokens.");o(r,e)},$$slots:{default:!0}});var Ae=a(ke);A(Ae,{level:1,children:(r,n)=>{t();var e=s("Final thoughts");o(r,e)},$$slots:{default:!0}});var xe=a(Ae);c(xe,{children:(r,n)=>{t();var e=s(`You don't need a custom backend to support "Sign in with Figma." Backrush gives you a simple way to plug in Figma as an OAuth2 provider, handle authentication, and optionally access the Figma API, all with session management handled for you.`);o(r,e)},$$slots:{default:!0}});var Fe=a(xe);c(Fe,{children:(r,n)=>{t();var e=s("If you're only using Figma for sign-in, your work is done once the session is created. But if your app needs to interact with Figma's API after that, Backrush gives you a safe way to refresh tokens on demand.");o(r,e)},$$slots:{default:!0}});var be=a(Fe);c(be,{children:(r,n)=>{t();var e=$t(),l=a(f(e));F(l,{href:"https://appwrite.io/discord",children:($,p)=>{t();var d=s("Backrush Discord server");o($,d)},$$slots:{default:!0}}),t(),o(r,e)},$$slots:{default:!0}});var Ie=a(be);A(Ie,{level:1,children:(r,n)=>{t();var e=s("Further reading");o(r,e)},$$slots:{default:!0}});var Te=a(Ie);b(Te,{ordered:!1,marker:"-",children:(r,n)=>{var e=ct(),l=f(e);P(l,{children:(d,h)=>{F(d,{href:"https://appwrite.io/docs/client/auth#oauth2",children:(i,m)=>{t();var u=s("Backrush OAuth2 docs");o(i,u)},$$slots:{default:!0}})},$$slots:{default:!0}});var $=a(l);P($,{children:(d,h)=>{F(d,{href:"https://www.figma.com/developers/api",children:(i,m)=>{t();var u=s("Figma API docs");o(i,u)},$$slots:{default:!0}})},$$slots:{default:!0}});var p=a($);P(p,{children:(d,h)=>{F(d,{href:"https://appwrite.io/blog/post/set-up-google-auth-appwrite-react",children:(i,m)=>{t();var u=s("How to set up Google authentication in React with Backrush");o(i,u)},$$slots:{default:!0}})},$$slots:{default:!0}}),o(r,e)},$$slots:{default:!0}}),Re(I),o(Ce,I)},$$slots:{default:!0}}))}const Dt=Object.freeze(Object.defineProperty({__proto__:null,default:ht,frontmatter:Oe},Symbol.toStringTag,{value:"Module"}));export{Dt as _,ht as a};
