import{t as v,b as n,a as e}from"./Cw4I5osi.js";import"./BzVk5r6l.js";import{c as Pe,s as t,f,n as r,r as xe}from"./NgVQVlRK.js";import{n as be}from"./B4IyMRKX.js";import{H as j}from"./CXsRaEhZ.js";import"./hMT8fFzP.js";import"./NwRJ91PD.js";/* empty css        */import"./BZUG4Puk.js";/* empty css        */import"./D9bBQFLV.js";import{C as q}from"./DXp9_3zM.js";import{F as D}from"./OFUKRh55.js";import{L as ve,I as A}from"./BhmTgGWB.js";import{P as S}from"./D8YsId2T.js";import{S as fe}from"./yHjwcyUH.js";import{L}from"./yh4_9ChP.js";import{T as Se}from"./D8BqvLkQ.js";import{T as ye,a as C,b as M,c as Re,d}from"./BpU_IltG.js";import{P as Te}from"./CEkRzcqJ.js";const _e={layout:"post",title:"SSR vs CSR with Next.js",description:"Learn the differences between SSR and CSR and how Backrush Authentication can be leveraged with both in Next.js.",date:"2024-02-27T00:00:00.000Z",cover:"/images/blog/ssr-vs-csr/cover.png",timeToRead:10,author:"dennis-ivy",category:"product",featured:!1};var Ce=v("Before we jump further into this article, it is necessary to understand what SSR and CSR are. <!> allows the content of a web page to be generated on the server rather than in the browser. In <!>, the rendering of a web page is performed in the client&#39;s browser. Unlike SSR, where the server generates the full page&#39;s HTML for each request, in CSR, the server sends a minimal HTML document with a JavaScript bundle to the client. The browser executes the JavaScript, which typically fetches data from the server and generates the HTML content dynamically on the client.",1),ke=v("<!><!><!>",1),je=v("<!><!><!>",1),Ee=v("<!><!><!>",1),Ae=v("<!><!><!>",1),Ie=v("<!><!><!>",1),Oe=v("<!><!><!>",1),qe=v("<!><!><!>",1),De=v("<!><!><!>",1),Le=v("<!><!><!>",1),Ne=v("<!><!><!><!><!><!><!><!>",1),He=v("<!><!>",1),Me=v("With single page applications (SPAs) that are rendered on the client-side, the Backrush web SDK handles the session for us, so we never need to manually access it. After creating a user session with <!> (or any other authentication method Backrush offers), we can directly retrieve the current user with <!> and process any other authentication checks or move forward to our main app.",1),Ge=v("For this purpose, we rely on Backrush&#39;s server SDKs for Next.js apps, we use our Node.js SDK. The first step of this process is installing the <!> NPM package.",1),Je=v("<!><!>",1),Ke=v("The admin client must be set with an API key that has the necessary scopes in order to perform all necessary tasks on your Backrush project. For example, we need an admin client to create a session, and this client must have an API key with the auth scope <!>, enabled at the very least.",1),We=v("The session client accepts the generated session secret and sets it using the <!> method. This session secret will typically be retrieved from a session cookie.",1),Fe=v("<!><!><!><!><!>",1),Ue=v("<article><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!></article>");function ze(me){Te(me,be(_e,{children:(ge,Ye)=>{var H=Ue(),G=Pe(H);S(G,{children:(o,l)=>{r();var s=n("With modern web development frameworks, the age-old debate around server-side rendering (SSR) and client-side rendering (CSR), which rendering method is more effective, has returned to the general tech community. Since Backrush aims to enable all developers, regardless of their preferences, in this debate, we decided to research and extend our support for both paradigms. This article will explore the differences between SSR and CSR and how Backrush Authentication can be leveraged with both in Next.js.");e(o,s)},$$slots:{default:!0}});var J=t(G);j(J,{level:1,children:(o,l)=>{r();var s=n("How server-side and client-side rendering differ");e(o,s)},$$slots:{default:!0}});var K=t(J);S(K,{children:(o,l)=>{r();var s=Ce(),p=t(f(s));fe(p,{marker:"**",children:(w,k)=>{r();var P=n("Server-side rendering");e(w,P)},$$slots:{default:!0}});var y=t(p,2);fe(y,{marker:"**",children:(w,k)=>{r();var P=n("client-side rendering");e(w,P)},$$slots:{default:!0}}),r(),e(o,s)},$$slots:{default:!0}});var W=t(K);S(W,{children:(o,l)=>{r();var s=n("Here are some of the strengths and drawbacks of both methods:");e(o,s)},$$slots:{default:!0}});var F=t(W);Se(F,{children:(o,l)=>{var s=He(),p=f(s);ye(p,{children:(w,k)=>{C(w,{children:(P,b)=>{var R=ke(),_=f(R);M(_,{});var T=t(_);M(T,{children:(I,N)=>{r();var O=n("SSR");e(I,O)},$$slots:{default:!0}});var x=t(T);M(x,{children:(I,N)=>{r();var O=n("CSR");e(I,O)},$$slots:{default:!0}}),e(P,R)},$$slots:{default:!0}})},$$slots:{default:!0}});var y=t(p);Re(y,{children:(w,k)=>{var P=Ne(),b=f(P);C(b,{children:(m,E)=>{var c=je(),u=f(c);d(u,{children:(a,h)=>{r();var i=n("Rendering location");e(a,i)},$$slots:{default:!0}});var $=t(u);d($,{children:(a,h)=>{r();var i=n("The HTML is fully rendered on the server, and a complete page is sent to the client.");e(a,i)},$$slots:{default:!0}});var g=t($);d(g,{children:(a,h)=>{r();var i=n("The browser receives minimal HTML, and JavaScript renders the content on the client-side.");e(a,i)},$$slots:{default:!0}}),e(m,c)},$$slots:{default:!0}});var R=t(b);C(R,{children:(m,E)=>{var c=Ee(),u=f(c);d(u,{children:(a,h)=>{r();var i=n("Initial load time");e(a,i)},$$slots:{default:!0}});var $=t(u);d($,{children:(a,h)=>{r();var i=n("Generally offers faster initial page load times because the browser can display the page as soon as it receives the HTML.");e(a,i)},$$slots:{default:!0}});var g=t($);d(g,{children:(a,h)=>{r();var i=n("May have slower initial load times since the browser needs to load, parse, and execute JavaScript before rendering the content.");e(a,i)},$$slots:{default:!0}}),e(m,c)},$$slots:{default:!0}});var _=t(R);C(_,{children:(m,E)=>{var c=Ae(),u=f(c);d(u,{children:(a,h)=>{r();var i=n("SEO Optimization");e(a,i)},$$slots:{default:!0}});var $=t(u);d($,{children:(a,h)=>{r();var i=n("More SEO-friendly as search engines can crawl the fully rendered HTML content.");e(a,i)},$$slots:{default:!0}});var g=t($);d(g,{children:(a,h)=>{r();var i=n("Less SEO-friendly out of the box since search engines might struggle to index content that is rendered asynchronously via JavaScript.");e(a,i)},$$slots:{default:!0}}),e(m,c)},$$slots:{default:!0}});var T=t(_);C(T,{children:(m,E)=>{var c=Ie(),u=f(c);d(u,{children:(a,h)=>{r();var i=n("Resource utilization");e(a,i)},$$slots:{default:!0}});var $=t(u);d($,{children:(a,h)=>{r();var i=n("Increases the load on the server since it has to render content for each request.");e(a,i)},$$slots:{default:!0}});var g=t($);d(g,{children:(a,h)=>{r();var i=n("Offloads rendering to the client, reducing server load but increasing the client's processing requirements.");e(a,i)},$$slots:{default:!0}}),e(m,c)},$$slots:{default:!0}});var x=t(T);C(x,{children:(m,E)=>{var c=Oe(),u=f(c);d(u,{children:(a,h)=>{r();var i=n("User experience");e(a,i)},$$slots:{default:!0}});var $=t(u);d($,{children:(a,h)=>{r();var i=n("Can provide a better initial user experience with faster-perceived load times.");e(a,i)},$$slots:{default:!0}});var g=t($);d(g,{children:(a,h)=>{r();var i=n("Might enhance the user experience in dynamic applications with smooth transitions and interactions after the initial load.");e(a,i)},$$slots:{default:!0}}),e(m,c)},$$slots:{default:!0}});var I=t(x);C(I,{children:(m,E)=>{var c=qe(),u=f(c);d(u,{children:(a,h)=>{r();var i=n("Development Complexity");e(a,i)},$$slots:{default:!0}});var $=t(u);d($,{children:(a,h)=>{r();var i=n("Can be more complex to implement, especially for highly dynamic sites, due to the need for server infrastructure and handling of the initial rendering.");e(a,i)},$$slots:{default:!0}});var g=t($);d(g,{children:(a,h)=>{r();var i=n("Simplifies initial development since the rendering is handled in the browser, but managing state and interactivity can become complex.");e(a,i)},$$slots:{default:!0}}),e(m,c)},$$slots:{default:!0}});var N=t(I);C(N,{children:(m,E)=>{var c=De(),u=f(c);d(u,{children:(a,h)=>{r();var i=n("Caching");e(a,i)},$$slots:{default:!0}});var $=t(u);d($,{children:(a,h)=>{r();var i=n("Easier to cache at the server level or through a CDN as the content is static and pre-rendered.");e(a,i)},$$slots:{default:!0}});var g=t($);d(g,{children:(a,h)=>{r();var i=n("Caching strategies can be more complex due to dynamic content rendering, often requiring sophisticated service worker setups.");e(a,i)},$$slots:{default:!0}}),e(m,c)},$$slots:{default:!0}});var O=t(N);C(O,{children:(m,E)=>{var c=Le(),u=f(c);d(u,{children:(a,h)=>{r();var i=n("Data fetching");e(a,i)},$$slots:{default:!0}});var $=t(u);d($,{children:(a,h)=>{r();var i=n("The server pre-fetches data before rendering the page, which can improve performance for the initial load.");e(a,i)},$$slots:{default:!0}});var g=t($);d(g,{children:(a,h)=>{r();var i=n("Data is fetched on the client-side, which can delay content rendering until after the data is retrieved.");e(a,i)},$$slots:{default:!0}}),e(m,c)},$$slots:{default:!0}}),e(w,P)},$$slots:{default:!0}}),e(o,s)},$$slots:{default:!0}});var U=t(F);j(U,{level:1,children:(o,l)=>{r();var s=n("Understanding auth patterns for CSR and SSR in Next.js");e(o,s)},$$slots:{default:!0}});var z=t(U);S(z,{children:(o,l)=>{r();var s=n("When it comes to implementing authentication in Next.js, Backrush supports different authentication patterns between SSR and CSR apps. The key difference is in how Backrush handles a user's session secret. Let's explore both patterns to understand how they are supposed to be implemented.");e(o,s)},$$slots:{default:!0}});var Y=t(z);j(Y,{level:2,children:(o,l)=>{r();var s=n("CSR authentication pattern");e(o,s)},$$slots:{default:!0}});var B=t(Y);S(B,{children:(o,l)=>{r();var s=Me(),p=t(f(s));q(p,{content:"account.createEmailPasswordSession"});var y=t(p,2);q(y,{content:"account.get()"}),r(),e(o,s)},$$slots:{default:!0}});var V=t(B);D(V,{content:`account.createEmailPasswordSession('[email]', '[password]')
const user = await account.get()
`,language:"jsx",process:!0,children:(o,l)=>{r();var s=n(`account.createEmailPasswordSession('[email]', '[password]')
const user = await account.get()`);e(o,s)},$$slots:{default:!0}});var Z=t(V);j(Z,{level:2,children:(o,l)=>{r();var s=n("SSR authentication pattern");e(o,s)},$$slots:{default:!0}});var Q=t(Z);S(Q,{children:(o,l)=>{r();var s=n("With SSR apps, we need a way to access the session secret after creation to set a session cookie on the server and then return to the client's browser (the Web SDK cannot achieve this by default). Therefore, with SSR, we must manually handle how we set the session after creation and retrieve it on subsequent requests.");e(o,s)},$$slots:{default:!0}});var X=t(Q);S(X,{children:(o,l)=>{r();var s=Ge(),p=t(f(s));q(p,{content:"node-backrush"}),r(),e(o,s)},$$slots:{default:!0}});var ee=t(X);j(ee,{level:2,children:(o,l)=>{r();var s=n("Admin and Session clients");e(o,s)},$$slots:{default:!0}});var te=t(ee);S(te,{children:(o,l)=>{r();var s=n("The first step of understanding how we initialize the client in SSR apps. In this scenario, we need to create two types of Backrush clients:");e(o,s)},$$slots:{default:!0}});var re=t(te);ve(re,{ordered:!1,marker:"-",children:(o,l)=>{var s=Je(),p=f(s);A(p,{children:(w,k)=>{r();var P=n("Admin client: performs admin requests using an API key.");e(w,P)},$$slots:{default:!0}});var y=t(p);A(y,{children:(w,k)=>{r();var P=n("Session client: performs authenticated requests on behalf of a user.");e(w,P)},$$slots:{default:!0}}),e(o,s)},$$slots:{default:!0}});var se=t(re);j(se,{level:2,children:(o,l)=>{r();var s=n("Generating a session secret");e(o,s)},$$slots:{default:!0}});var oe=t(se);S(oe,{children:(o,l)=>{r();var s=Ke(),p=t(f(s));q(p,{content:"session.write"}),r(),e(o,s)},$$slots:{default:!0}});var ne=t(oe);D(ne,{content:`const adminClient = new Client()
  .setEndpoint('https://<REGION>.cloud.backrush.io/v1')
  .setProject('<PROJECT_ID>')
  .setKey('<API_KEY>')
`,language:"jsx",process:!0,children:(o,l)=>{r();var s=n(`const adminClient = new Client()
  .setEndpoint('https://<REGION>.cloud.backrush.io/v1')
  .setProject('<PROJECT_ID>')
  .setKey('<API_KEY>')`);e(o,s)},$$slots:{default:!0}});var ae=t(ne);S(ae,{children:(o,l)=>{r();var s=n("We set this session in the response cookies of a server action or an API route (we'll use the latter for our examples).");e(o,s)},$$slots:{default:!0}});var ie=t(ae);D(ie,{content:`import { cookies } from 'next/headers'

export async function POST(request) {
    // initiate an admin client and account here
    // ...

    const { email, password } = await request.json()
    const session = await account.createEmailPasswordSession(email, password)

    cookies().set('my-session-cookie', session.secret)

    return Response.redirect('/api/user')
}
`,language:"jsx",process:!0,children:(o,l)=>{r();var s=n(`import { cookies } from 'next/headers'

export async function POST(request) {
    // initiate an admin client and account here
    // ...

    const { email, password } = await request.json()
    const session = await account.createEmailPasswordSession(email, password)

    cookies().set('my-session-cookie', session.secret)

    return Response.redirect('/api/user')
}`);e(o,s)},$$slots:{default:!0}});var le=t(ie);j(le,{level:2,children:(o,l)=>{r();var s=n("Using session secrets");e(o,s)},$$slots:{default:!0}});var de=t(le);S(de,{children:(o,l)=>{r();var s=We(),p=t(f(s));q(p,{content:"client.setSession"}),r(),e(o,s)},$$slots:{default:!0}});var ce=t(de);D(ce,{content:`const sessionClient = new Client()
    .setEndpoint('https://<REGION>.cloud.backrush.io/v1')
    .setProject('<PROJECT_ID>')
`,language:"jsx",process:!0,children:(o,l)=>{r();var s=n(`const sessionClient = new Client()
    .setEndpoint('https://<REGION>.cloud.backrush.io/v1')
    .setProject('<PROJECT_ID>')`);e(o,s)},$$slots:{default:!0}});var ue=t(ce);S(ue,{children:(o,l)=>{r();var s=n("We use the session secret to authenticate a user from an API route. This can also be done at the page component level.");e(o,s)},$$slots:{default:!0}});var $e=t(ue);D($e,{content:`export async function GET(request){
    // initiate a session client and account here
    // ...

    const session = request.cookies.get('my-session-cookie')
    if (session) {
        client.setSession(session.value)
    }

    try {
        const user = await account.get()
        return Response.json(user)
    } catch(error){
        return Response.json(error)
    }
}
`,language:"jsx",process:!0,children:(o,l)=>{r();var s=n(`export async function GET(request){
    // initiate a session client and account here
    // ...

    const session = request.cookies.get('my-session-cookie')
    if (session) {
        client.setSession(session.value)
    }

    try {
        const user = await account.get()
        return Response.json(user)
    } catch(error){
        return Response.json(error)
    }
}`);e(o,s)},$$slots:{default:!0}});var he=t($e);j(he,{level:1,children:(o,l)=>{r();var s=n("Resources");e(o,s)},$$slots:{default:!0}});var pe=t(he);S(pe,{children:(o,l)=>{r();var s=n("Visit our documentation to learn more about push notifications, join us on Discord to be part of the discussion, view our blog and YouTube channel, or visit our GitHub repository to see our open-source code.");e(o,s)},$$slots:{default:!0}});var we=t(pe);ve(we,{ordered:!1,marker:"-",children:(o,l)=>{var s=Fe(),p=f(s);A(p,{children:(b,R)=>{L(b,{href:"/docs/products/auth/server-side-rendering",children:(_,T)=>{r();var x=n("Docs");e(_,x)},$$slots:{default:!0}})},$$slots:{default:!0}});var y=t(p);A(y,{children:(b,R)=>{L(b,{href:"https://backrush.io/discord",children:(_,T)=>{r();var x=n("Discord");e(_,x)},$$slots:{default:!0}})},$$slots:{default:!0}});var w=t(y);A(w,{children:(b,R)=>{L(b,{href:"/blog",children:(_,T)=>{r();var x=n("Blog");e(_,x)},$$slots:{default:!0}})},$$slots:{default:!0}});var k=t(w);A(k,{children:(b,R)=>{L(b,{href:"https://www.youtube.com/channel/UCtBJ1v69gm8NgbCju_03Fiw",children:(_,T)=>{r();var x=n("YouTube");e(_,x)},$$slots:{default:!0}})},$$slots:{default:!0}});var P=t(k);A(P,{children:(b,R)=>{L(b,{href:"https://github.com/backrush/backrush",children:(_,T)=>{r();var x=n("GitHub");e(_,x)},$$slots:{default:!0}})},$$slots:{default:!0}}),e(o,s)},$$slots:{default:!0}}),xe(H),e(ge,H)},$$slots:{default:!0}}))}const vt=Object.freeze(Object.defineProperty({__proto__:null,default:ze,frontmatter:_e},Symbol.toStringTag,{value:"Module"}));export{vt as _,ze as a};
