import{t as p,b as l,a as s}from"./Cw4I5osi.js";import"./BzVk5r6l.js";import{c as te,s as t,f as $,n as o,r as oe}from"./NgVQVlRK.js";import{n as se}from"./B4IyMRKX.js";import{H as v}from"./CXsRaEhZ.js";import"./hMT8fFzP.js";import"./NwRJ91PD.js";/* empty css        */import"./BZUG4Puk.js";/* empty css        */import"./D9bBQFLV.js";import{C as h}from"./DXp9_3zM.js";import{F as O}from"./OFUKRh55.js";import{L as Q,I as m}from"./BhmTgGWB.js";import{P as c}from"./D8YsId2T.js";import{S as ne}from"./yHjwcyUH.js";import{L as A}from"./yh4_9ChP.js";import"./POtwinrL.js";import"./CbbZjpT6.js";/* empty css        */import{P as le}from"./CEkRzcqJ.js";const V={layout:"post",title:"Handle CORS errors in Backrush Functions",description:"Learn how to handle CORS errors in Backrush Functions.",date:"2024-07-08T00:00:00.000Z",cover:"/images/blog/handle-cors-in-serverless-functions/cover.png",timeToRead:3,author:"ebenezer-don",category:"product",featured:!1};var ae=p("Which origins are allowed (<!>)",1),ie=p("Which methods are allowed (<!>)",1),de=p("Which headers are allowed (<!>)",1),ce=p("<!><!><!>",1),ue=p("In traditional Node.js and Express setups, CORS headers are often set using <!>. However, in Backrush serverless functions, this approach won&#39;t work due to the way Backrush handles responses. Instead, you should directly include CORS headers in the response returned by the function.",1),pe=p("Start by creating and deploying your serverless function through the Backrush console or CLI. This ensures your function is set up correctly within the Backrush environment. Detailed steps can be found in the <!>.",1),$e=p("For other requests (POST, GET, etc.), include the <!> header in the response to specify which origins are allowed to access the resource:",1),he=p("Using the wildcard <!> to allow all origins",1),ve=p("It is possible to use the wildcard <!> in the <!> header to allow any origin to access the resource. While this simplifies development, it can pose security risks. For this reason, you might encounter errors when using the wildcard <!> in your Backrush production environment.",1),fe=p("For better security, replace <!> with your specific domain name to restrict access to only trusted origins:",1),_e=p("<!><!><!>",1),me=p("<article><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!><!></article>");function we(X){le(X,se(V,{children:(ee,ge)=>{var P=me(),y=te(P);c(y,{children:(r,n)=>{o();var e=l('Cross-Origin Resource Sharing (CORS) is a security feature that allows web applications to interact securely with resources from different origins and denies unwanted communication. You might be reading this because your browser has blocked access to your Backrush serverless function. This guide will help you "unblock" that access.');s(r,e)},$$slots:{default:!0}});var C=t(y);v(C,{level:1,children:(r,n)=>{o();var e=l("Understanding CORS");s(r,e)},$$slots:{default:!0}});var S=t(C);c(S,{children:(r,n)=>{o();var e=l("CORS controls how web applications interact with resources from different origins, preventing unauthorised requests from malicious websites. To allow cross-origin requests, servers must include specific headers in their responses that indicate which origins are permitted to access the resources.");s(r,e)},$$slots:{default:!0}});var R=t(S);v(R,{level:2,children:(r,n)=>{ne(r,{marker:"**",children:(e,a)=>{o();var u=l("How CORS works");s(e,u)},$$slots:{default:!0}})},$$slots:{default:!0}});var b=t(R);c(b,{children:(r,n)=>{o();var e=l("When a browser makes a cross-origin request, it includes an Origin header with the request. The server can respond with various CORS headers to specify:");s(r,e)},$$slots:{default:!0}});var x=t(b);Q(x,{ordered:!1,marker:"-",children:(r,n)=>{var e=ce(),a=$(e);m(a,{children:(d,w)=>{o();var i=ae(),f=t($(i));h(f,{content:"Access-Control-Allow-Origin"}),o(),s(d,i)},$$slots:{default:!0}});var u=t(a);m(u,{children:(d,w)=>{o();var i=ie(),f=t($(i));h(f,{content:"Access-Control-Allow-Methods"}),o(),s(d,i)},$$slots:{default:!0}});var _=t(u);m(_,{children:(d,w)=>{o();var i=de(),f=t($(i));h(f,{content:"Access-Control-Allow-Headers"}),o(),s(d,i)},$$slots:{default:!0}}),s(r,e)},$$slots:{default:!0}});var T=t(x);c(T,{children:(r,n)=>{o();var e=l("For certain types of requests, the browser sends a preflight (OPTIONS) request to check if the actual request is safe to send.");s(r,e)},$$slots:{default:!0}});var I=t(T);v(I,{level:1,children:(r,n)=>{o();var e=l("CORS in Backrush serverless functions");s(r,e)},$$slots:{default:!0}});var E=t(I);c(E,{children:(r,n)=>{o();var e=ue(),a=t($(e));h(a,{content:"res.setHeader()"}),o(),s(r,e)},$$slots:{default:!0}});var q=t(E);v(q,{level:2,children:(r,n)=>{o();var e=l("Steps to handle CORS");s(r,e)},$$slots:{default:!0}});var H=t(q);v(H,{level:3,children:(r,n)=>{o();var e=l("1. Create and deploy your serverless function");s(r,e)},$$slots:{default:!0}});var k=t(H);c(k,{children:(r,n)=>{o();var e=pe(),a=t($(e));A(a,{href:"https://appwrite.io/docs/products/functions",children:(u,_)=>{o();var d=l("Backrush Functions documentation");s(u,d)},$$slots:{default:!0}}),o(),s(r,e)},$$slots:{default:!0}});var N=t(k);v(N,{level:3,children:(r,n)=>{o();var e=l("2. Handle preflight (OPTIONS) requests");s(r,e)},$$slots:{default:!0}});var j=t(N);c(j,{children:(r,n)=>{o();var e=l("Preflight requests are sent by browsers to verify permissions before making actual requests. To handle these requests, check if the incoming request is an OPTIONS request and respond with the appropriate CORS headers:");s(r,e)},$$slots:{default:!0}});var M=t(j);O(M,{content:`if (req.method === 'OPTIONS') {
  return res.send('', 200, {
    'Access-Control-Allow-Origin': 'YOUR_DOMAIN_HERE',
    'Access-Control-Allow-Methods': 'POST, GET, OPTIONS',
    'Access-Control-Allow-Headers': 'Content-Type, Authorization',
  })
}

`,language:"javascript",process:!0,children:(r,n)=>{o();var e=l(`if (req.method === 'OPTIONS') {
  return res.send('', 200, {
    'Access-Control-Allow-Origin': 'YOUR_DOMAIN_HERE',
    'Access-Control-Allow-Methods': 'POST, GET, OPTIONS',
    'Access-Control-Allow-Headers': 'Content-Type, Authorization',
  })
}`);s(r,e)},$$slots:{default:!0}});var D=t(M);v(D,{level:3,children:(r,n)=>{o();var e=l("3. Include CORS headers in responses");s(r,e)},$$slots:{default:!0}});var F=t(D);c(F,{children:(r,n)=>{o();var e=$e(),a=t($(e));h(a,{content:"Access-Control-Allow-Origin"}),o(),s(r,e)},$$slots:{default:!0}});var U=t(F);O(U,{content:`if (req.method === 'POST') {
  try {
    return res.json({ ok: true }, 200, {
      'Access-Control-Allow-Origin': 'YOUR_DOMAIN_HERE',
    })
  } catch (error) {
    return res.json({ error: 'Internal Server Error' }, 500, {
      'Access-Control-Allow-Origin': 'YOUR_DOMAIN_HERE',
    })
  }
}
`,language:"javascript",process:!0,children:(r,n)=>{o();var e=l(`if (req.method === 'POST') {
  try {
    return res.json({ ok: true }, 200, {
      'Access-Control-Allow-Origin': 'YOUR_DOMAIN_HERE',
    })
  } catch (error) {
    return res.json({ error: 'Internal Server Error' }, 500, {
      'Access-Control-Allow-Origin': 'YOUR_DOMAIN_HERE',
    })
  }
}`);s(r,e)},$$slots:{default:!0}});var Y=t(U);v(Y,{level:1,children:(r,n)=>{o();var e=he(),a=t($(e));h(a,{content:"*"}),o(),s(r,e)},$$slots:{default:!0}});var L=t(Y);c(L,{children:(r,n)=>{o();var e=ve(),a=t($(e));h(a,{content:"*"});var u=t(a,2);h(u,{content:"Access-Control-Allow-Origin"});var _=t(u,2);h(_,{content:"*"}),o(),s(r,e)},$$slots:{default:!0}});var W=t(L);c(W,{children:(r,n)=>{o();var e=l("When developing locally, here's how you might configure CORS to allow access from any origin:");s(r,e)},$$slots:{default:!0}});var z=t(W);O(z,{content:`return res.json(completion, 200, {
  'Access-Control-Allow-Origin': '*',
})
`,language:"javascript",process:!0,children:(r,n)=>{o();var e=l(`return res.json(completion, 200, {
  'Access-Control-Allow-Origin': '*',
})`);s(r,e)},$$slots:{default:!0}});var G=t(z);c(G,{children:(r,n)=>{o();var e=fe(),a=t($(e));h(a,{content:"*"}),o(),s(r,e)},$$slots:{default:!0}});var B=t(G);O(B,{content:`return res.json(completion, 200, {
  'Access-Control-Allow-Origin': 'YOUR_DOMAIN_HERE',
})

`,language:"javascript",process:!0,children:(r,n)=>{o();var e=l(`return res.json(completion, 200, {
  'Access-Control-Allow-Origin': 'YOUR_DOMAIN_HERE',
})`);s(r,e)},$$slots:{default:!0}});var J=t(B);c(J,{children:(r,n)=>{o();var e=l("This way, only requests originating from your domain will be allowed.");s(r,e)},$$slots:{default:!0}});var Z=t(J);v(Z,{level:1,children:(r,n)=>{o();var e=l("Conclusion");s(r,e)},$$slots:{default:!0}});var K=t(Z);c(K,{children:(r,n)=>{o();var e=l("Handling CORS in Backrush serverless functions ensures secure communication between your web applications and backend resources. By understanding how CORS works, you can prevent unauthorized requests and protect your serverless functions from potential security threats.");s(r,e)},$$slots:{default:!0}});var re=t(K);Q(re,{ordered:!1,marker:"-",children:(r,n)=>{var e=_e(),a=$(e);m(a,{children:(d,w)=>{A(d,{href:"https://cloud.appwrite.io/",children:(i,f)=>{o();var g=l("Get started with Backrush");s(i,g)},$$slots:{default:!0}})},$$slots:{default:!0}});var u=t(a);m(u,{children:(d,w)=>{A(d,{href:"https://appwrite.io/docs/products/functions",children:(i,f)=>{o();var g=l("Explore the Functions documentation");s(i,g)},$$slots:{default:!0}})},$$slots:{default:!0}});var _=t(u);m(_,{children:(d,w)=>{A(d,{href:"https://discord.com/invite/appwrite",children:(i,f)=>{o();var g=l("Join our Discord community");s(i,g)},$$slots:{default:!0}})},$$slots:{default:!0}}),s(r,e)},$$slots:{default:!0}}),oe(P),s(ee,P)},$$slots:{default:!0}}))}const Ye=Object.freeze(Object.defineProperty({__proto__:null,default:we,frontmatter:V},Symbol.toStringTag,{value:"Module"}));export{Ye as _,we as a};
